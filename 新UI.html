<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duty-Agent Fluent UI Prototype</title>
    <!-- Use fluent UI font stack -->
    <style>
        :root {
            --bg-body: #f3f3f3;
            --bg-card: #ffffff;
            --border: #e6e6e6;
            --primary: #005a9e;
            /* Fluent Blue */
            --primary-hover: #004a80;
            --text-main: #242424;
            --text-sub: #5c5c5c;
            --radius-card: 8px;
            --radius-input: 4px;
        }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: "Segoe UI Variable", "Segoe UI", "å¾®è½¯é›…é»‘", sans-serif;
            margin: 0;
            padding: 32px 0;
            display: flex;
            justify-content: center;
        }

        .container {
            width: 860px;
            max-width: 95%;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .page-header {
            margin-bottom: 8px;
        }

        .page-header h1 {
            font-size: 28px;
            font-weight: 600;
            margin: 0 0 4px 0;
        }

        .page-header p {
            margin: 0;
            color: var(--text-sub);
            font-size: 14px;
        }

        /* Fluent Card */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-card);
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
        }

        .card-desc {
            font-size: 13px;
            color: var(--text-sub);
            margin: 0;
        }

        /* Core Action Section */
        .core-action-card {
            border-left: 4px solid var(--primary);
        }

        /* Inputs & Buttons */
        textarea,
        input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            font-family: inherit;
            border: 1px solid #d1d1d1;
            border-radius: var(--radius-input);
            border-bottom: 2px solid #d1d1d1;
            background: #fafafa;
            transition: all 0.2s;
            resize: vertical;
        }

        textarea:focus,
        input[type="text"]:focus {
            outline: none;
            border-bottom-color: var(--primary);
            background: #fff;
        }

        button {
            font-family: inherit;
            padding: 8px 16px;
            border-radius: var(--radius-input);
            border: 1px solid #ccc;
            background: #fdfdfd;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.15s;
        }

        button:hover {
            background: #f0f0f0;
        }

        button.primary {
            background: var(--primary);
            color: white;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 90, 158, 0.2);
        }

        button.primary:hover {
            background: var(--primary-hover);
            box-shadow: 0 2px 6px rgba(0, 90, 158, 0.3);
        }

        button.primary:disabled {
            background: #a0a0a0;
            box-shadow: none;
            cursor: not-allowed;
        }

        /* Expander Component */
        .expander {
            border: 1px solid var(--border);
            border-radius: var(--radius-card);
            background: var(--bg-card);
            overflow: hidden;
            margin-top: 8px;
            /* Extra separation for deep settings */
        }

        .expander-header {
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            background: var(--bg-card);
            transition: background 0.2s;
        }

        .expander-header:hover {
            background: #fcfcfc;
        }

        .expander-title {
            font-weight: 600;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .expander-icon {
            font-size: 12px;
            transition: transform 0.3s ease;
        }

        .expander.open .expander-icon {
            transform: rotate(180deg);
        }

        .expander-content {
            padding: 0 20px;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: #fafafa;
            border-top: 1px solid transparent;
        }

        .expander.open .expander-content {
            padding: 20px;
            max-height: 800px;
            /* arbitrary large value */
            opacity: 1;
            border-top-color: var(--border);
        }

        /* Reasoning Board - The Magic Part */
        .reasoning-board {
            background: #202020;
            color: #cccccc;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            border-radius: 6px;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin-top: 0;
            position: relative;
        }

        .reasoning-board.expanded {
            max-height: 250px;
            opacity: 1;
            padding: 16px;
            margin-top: 12px;
            overflow-y: auto;
            border: 1px solid #3d3d3d;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .reasoning-board.success {
            animation: pulseGreen 1s ease;
        }

        @keyframes pulseGreen {
            0% {
                box-shadow: 0 0 0 0 rgba(16, 124, 16, 0.4);
                border-color: #107c10;
            }

            100% {
                box-shadow: 0 0 0 10px rgba(16, 124, 16, 0);
                border-color: #3d3d3d;
            }
        }

        .type-cursor {
            animation: blink 1s step-end infinite;
            font-weight: bold;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        /* Schedule Preview List */
        .schedule-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            opacity: 0.6;
            filter: grayscale(80%);
            transition: all 0.5s ease;
            pointer-events: none;
        }

        .schedule-list.active {
            opacity: 1;
            filter: grayscale(0%);
            pointer-events: auto;
        }

        .schedule-item {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            border-left: 3px solid #ccc;
            transition: all 0.3s ease;
        }

        .schedule-list.active .schedule-item {
            border-left-color: var(--primary);
            background: #fdfdfd;
        }

        .schedule-date {
            min-width: 90px;
            font-weight: 600;
            color: var(--text-main);
            font-size: 14px;
        }

        .schedule-content {
            font-size: 13px;
            color: var(--text-sub);
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="page-header">
            <h1>âš™ï¸ Duty-Agent è®¾ç½®</h1>
            <p>é¢å‘æ™®é€šç”¨æˆ·ï¼šé…ç½®æ’ç­ã€æ‰§è¡Œä»»åŠ¡ã€ç®¡ç†åå•ã€‚</p>
        </div>

        <!-- TIER 1: The Core Action Zone (Operations & Results tightly coupled) -->

        <div class="card core-action-card">
            <div class="card-header">
                <span style="font-size: 18px;">â–¶</span>
                <h3 class="card-title">æ‰§è¡Œæ’ç­å¤§æ¨¡å‹</h3>
            </div>
            <p class="card-desc">è¾“å…¥é™„åŠ è¦æ±‚å¹¶å¯åŠ¨å¤§æ¨¡å‹æ¨æ¼”ã€‚æ­¤å¤„ç”Ÿæˆçš„æ’ç­ç»“æœå°†ç›´æ¥åœ¨ä¸‹æ–¹ç”Ÿæ•ˆã€‚</p>

            <textarea rows="2" placeholder="ï¼ˆå¯é€‰ï¼‰è¯·è¾“å…¥æœ¬æ¬¡æ’ç­æŒ‡ä»¤ï¼›ä¾‹å¦‚ï¼šæ˜å¤©å¤§æ‰«é™¤ï¼Œéœ€è¦é¢å¤–åŠ ä¸¤äºº...ç•™ç©ºå°†æŒ‰é»˜è®¤å‚æ•°æ‰§è¡Œã€‚"></textarea>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 4px;">
                <span style="font-size: 12px; color: #888;">è¿è¡ŒçŠ¶æ€ï¼šå¾…å‘½ | æ•°æ®ï¼šæ­£å¸¸</span>
                <button id="runBtn" class="primary" onclick="startGeneration()">
                    <span></span> å¼€å§‹æ’ç­è®¡ç®—
                </button>
            </div>

            <!-- THE REASONING BOARD (Initially hidden, expands natively) -->
            <div id="reasoningBoard" class="reasoning-board">
                <div id="streamContent"></div>
                <span class="type-cursor">_</span>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <span style="font-size: 18px;">ğŸ“–</span>
                <h3 class="card-title">æ’ç­ç»“æœé¢„è§ˆä¸ç¼–è¾‘</h3>
            </div>
            <p class="card-desc">å½“å‰ç³»ç»Ÿçš„æœ€ç»ˆæ’ç­åˆ—è¡¨ï¼Œæ‰€æœ‰ä¿®æ”¹å‡ä¼šå®æ—¶ä¿å­˜ç”Ÿæ•ˆã€‚</p>

            <div id="schedulePreview" class="schedule-list">
                <!-- Stale Data State -->
                <div class="schedule-item">
                    <div class="schedule-date">2026-10-23<br><span
                            style="font-size: 12px; font-weight: normal; color: #888;">å‘¨äº”</span></div>
                    <div class="schedule-content">
                        <div style="margin-bottom: 4px;"><strong>æ•™å®¤</strong>: åˆ˜ä¸€, é™ˆäºŒ</div>
                        <div><strong>èµ°å»Š</strong>: å¼ ä¸‰</div>
                    </div>
                </div>
                <div class="schedule-item">
                    <div class="schedule-date">2026-10-24<br><span
                            style="font-size: 12px; font-weight: normal; color: #888;">å‘¨å…­</span></div>
                    <div class="schedule-content">
                        <span style="color: #999; font-style: italic;">(å‘¨æœ«æ— å®‰æ’)</span>
                    </div>
                </div>
            </div>
        </div>


        <!-- TIER 2: Static / Low-Frequency Settings (Stored inside Expanders / Cards at the bottom) -->

        <div class="expander" onclick="toggleExpander('rosterExp')">
            <div class="expander-header">
                <div class="expander-title"><span>ğŸ‘¥</span> èŠ±åå†Œç®¡ç†</div>
                <div class="expander-icon">â–¼</div>
            </div>
            <div id="rosterExp" class="expander-content" onclick="event.stopPropagation()">
                <p class="card-desc" style="margin-bottom: 12px;">ç®¡ç†ç­çº§åå•ã€å‡æ¡çŠ¶æ€å’Œå¯¼å‡ºå¯¼å…¥ã€‚</p>
                <div
                    style="height: 150px; background: #eee; border: 1px dashed #ccc; display: flex; align-items: center; justify-content: center; color: #888; border-radius: 4px;">
                    [ é•¿é•¿çš„äººå‘˜åˆ—è¡¨ ListBox å®¹å™¨ ]
                </div>
            </div>
        </div>

        <div class="expander" onclick="toggleExpander('apiExp')">
            <div class="expander-header">
                <div class="expander-title"><span>ğŸ”—</span> API è¿æ¥ä¸é•¿æœŸè§„åˆ™</div>
                <div class="expander-icon">â–¼</div>
            </div>
            <div id="apiExp" class="expander-content" onclick="event.stopPropagation()">
                <p class="card-desc" style="margin-bottom: 16px;">é…ç½®åº•å±‚å¤§æ¨¡å‹çš„ç½‘ç»œè¿æ¥å’Œæ³¨å…¥ç³»ç»Ÿçš„å…¨å±€ Prompt å‚æ•°ã€‚</p>

                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <div>
                        <label style="font-size: 13px; font-weight: 600;">API Key</label>
                        <input type="text" placeholder="sk-..." style="margin-top: 4px;">
                    </div>
                    <div>
                        <label style="font-size: 13px; font-weight: 600;">Base URL</label>
                        <input type="text" value="https://api.moonshot.cn/v1" style="margin-top: 4px;">
                    </div>
                    <div>
                        <label style="font-size: 13px; font-weight: 600;">AI é•¿æœŸè§„åˆ™</label>
                        <textarea rows="3" style="margin-top: 4px;">ç¦æ­¢è¿ç»­ä¸¤å¤©å®‰æ’åŒä¸€ä¸ªäººè´Ÿè´£æœ€ç´¯çš„æ´»...</textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="expander" onclick="toggleExpander('paramExp')">
            <div class="expander-header">
                <div class="expander-title"><span>âš™ï¸</span> æ’ç­å®šæ—¶æœåŠ¡å‚æ•°</div>
                <div class="expander-icon">â–¼</div>
            </div>
            <div id="paramExp" class="expander-content" onclick="event.stopPropagation()">
                <p class="card-desc">é…ç½®å®šæ—¶é™é»˜è‡ªåŠ¨æ’ç­çš„æ—¶é—´èŠ‚ç‚¹ç­‰ç¡¬ç¼–ç é€»è¾‘é…ç½®ã€‚</p>
                <div style="margin-top: 10px; font-size: 13px;">[ å®šæ—¶å™¨å¼€å…³ã€æ˜ŸæœŸé€‰æ‹©ä¸‹æ‹‰æ¡†ç­‰ ]</div>
            </div>
        </div>

    </div>

    <script>
        function toggleExpander(id) {
            const content = document.getElementById(id);
            const parent = content.parentElement;
            parent.classList.toggle('open');
        }

        const mockStream = [
            "[SYSTEM]: æ­£åœ¨æŒ‚è½½ Agent ç¯å¢ƒ...",
            "[THINK]: æ£€æµ‹åˆ°æ—¥æœŸè·³è·ƒï¼Œä¸Šå‘¨æœ‰é—ç•™ Debt(13, 14)ã€‚",
            "[THINK]: å‘¨äº”éœ€è¦ 3 äººã€‚ä¼˜å…ˆçº§æ’åº: Debt > Normal",
            "[THINK]: æŠ½å– ID: 13, 14, 18ï¼Œæ»¡è¶³æ¡ä»¶ã€‚",
            "[THINK]: æ­£åœ¨æ„å»º JSON payload...",
            "[SYSTEM]: æ”¶åˆ°åˆæ³• JSON å“åº”ã€‚",
            "[IPC]: æ•°æ®å·²æŒä¹…åŒ–è‡³ state.json"
        ];

        async function startGeneration() {
            const btn = document.getElementById('runBtn');
            const board = document.getElementById('reasoningBoard');
            const streamContainer = document.getElementById('streamContent');
            const preview = document.getElementById('schedulePreview');

            // Reset State
            btn.disabled = true;
            btn.innerHTML = "â³ æ­£åœ¨æ¨æ¼”ä¸­...";
            streamContainer.innerHTML = "";
            preview.classList.remove('active');
            board.classList.remove('success');

            // 1. Expand the board right below the button
            board.classList.add('expanded');

            // 2. Stream typing
            for (let i = 0; i < mockStream.length; i++) {
                await new Promise(r => setTimeout(r, 400 + Math.random() * 300));
                const p = document.createElement('div');
                p.innerText = mockStream[i];

                if (p.innerText.includes('Debt')) p.style.color = '#ffaa00';
                if (p.innerText.includes('æŒä¹…åŒ–')) p.style.color = '#107c10';

                streamContainer.appendChild(p);
                board.scrollTop = board.scrollHeight; // Keep scrolled to bottom
            }

            // 3. Success state & Flying transition to List below
            board.classList.add('success');
            btn.innerHTML = "â–¶ å¼€å§‹æ’ç­è®¡ç®—";
            btn.disabled = false;

            setTimeout(() => {
                // Update the preview list UI to show "fresh" data
                preview.innerHTML = `
                <div class="schedule-item" style="background: #e6f2ff;">
                    <div class="schedule-date">2026-10-23<br><span style="font-size: 12px; font-weight: normal; color: #005a9e;">æ˜å¤©/å‘¨äº”</span></div>
                    <div class="schedule-content">
                        <div style="margin-bottom: 4px;"><strong>æ•™å®¤</strong>: æå›› (<span style="color:#c42b1c">å‰å€ºå¿è¿˜</span>), ç‹äº”</div>
                        <div><strong>èµ°å»Š</strong>: èµµå…­</div>
                    </div>
                </div>
                <div class="schedule-item">
                    <div class="schedule-date">2026-10-24<br><span style="font-size: 12px; font-weight: normal; color: #888;">å‘¨å…­</span></div>
                    <div class="schedule-content">
                        <div style="margin-bottom: 4px;"><strong>æ•™å®¤</strong>: å­™ä¸ƒ, å‘¨å…«</div>
                        <div><strong>èµ°å»Š</strong>: å´ä¹</div>
                    </div>
                </div>
            `;
                // Trigger visual pop-in (remove grayscale, highlight borders)
                preview.classList.add('active');
            }, 500);
        }
    </script>

</body>

</html>
